library("httr", lib.loc="~/R/win-library/3.2")

phospho.ELM_domains=fread("name\tn_instances\nABL1 SH2	22\nABL2 SH2	1\nAPBA1 PTB	1\nAPBA2 PTB	1\nAPBA3 PTB	1\nAPBB1 PTB	1\nBLK SH2	4\nBLNK SH2	1\nBTRC WD40	4\nCBLB SH2	1\nCBL PTB	5\nCBL SH2	4\nCDC25C 14-3-3	1\nCISH SH2	5\nCRKL SH2	47\nCRK SH2	37\nCsk SH2	14\nDAB1 PTB	3\nDOK_group PTB	1\nFER SH2	1\nFES SH2	5\nFGR SH2	4\nFRS2 PTB	3\nFyn SH2	34\nGRAP2 SH2	7\nGRAP SH2	1\nGRB10 SH2	19\nGRB14 SH2	3\nGRB2 SH2	65\nGRB7 SH2	11\nGULP1 PTB	1\nINPP5D SH2	19\nINPPL1 SH2	1\nIRS1 PTB	4\nIRS2 PTB	1\nITK SH2	4\nJAK2 SH2	1\nLck SH2	31\nLCP2 SH2	2\nLyn SH2	11\nMAGI1 WW	1\nMAPK8IP2 PTB	1\nMATK SH2	7\nMDC1 FHA	1\nMKI67 FHA	2\nNCK SH2	27\nNPHP1 14-3-3	1\nPIK3R1 SH2	71\nPIK3R2 SH2	10\nPIN1 WW	29\nPLCG1 SH2	51\nPLCG2 SH2	13\nPLCG_group SH2	14\nPLK1 PBD	3\nPPP1R8 FHA	3\nPTK6 SH2	1\nPTPN11 SH2	60\nPTPN6 SH2	23\nRASA_group SH2	29\nSFN 14-3-3	28\nSH2B1 SH2	6\nSH2B2 SH2	2\nSH2D1A SH2	5\nSH2D1B SH2	3\nSH2D2A SH2	1\nSH2D3C SH2	1\nSH3BP2 SH2	1\nSHB SH2	4\nSHC1 PTB	12\nSHC1 SH2	43\nSHC2 SH2	2\nSHC3 PTB	4\nSHC3 SH2	2\nSHC_group SH2	19\nSHC PTB	5\nSLA SH2	2\nSOCS1 SH2	1\nSOCS2 SH2	2\nSOCS3 SH2	5\nSOCS_group SH2	1\nSrc SH2	47\nSTAT1 SH2	7\nSTAT2 SH2	4\nSTAT3 SH2	24\nSTAT5 SH2	24\nSTAT6 SH2	3\nSYK SH2	22\nTLN1 PTB	1\nTYK2 SH2	2\nVAV1 SH2	12\nVAV2 SH2	3\nVAV_group SH2	11\nYES1 SH2	5\nYWHAB 14-3-3	35\nYWHAE 14-3-3	26\nYWHAG 14-3-3	31\nYWHAH 14-3-3	28\nYWHAQ 14-3-3	35\nYWHAZ 14-3-3	38\nZAP70 SH2	14")

dt = rbindlist(lapply(phospho.ELM_domains[,name],function(name) fread(gsub("; ",";",content(POST("http://phospho.elm.eu.org/cgimodel.py",
                   body=list(substrate="",accession="",kinase="None",sh2=name,organisms="instances_vertebrates",outputCSV="on",fun="Search"),encode="multipart"))))[,pYReader:=name]))
dt
# dt3=dt[Residue=="Y",.(PMIDs=list(PMID),
#                   BindingDomain=unique(str_split(BindingDomain,pattern=",")),
#                   kinase=list(unique(Kinase)),
#                   grp=.GRP),by=.(Accession,Position,Context,SMART,IUPREDScore,PDB,`P3D-Acc`,pyReader)]

dt3=unique(dt[Residue=="Y",.(Accession,Position,pyReader)])
fwritelist(dt3,"../Data/phospho.ELM.pYReader.tsv")


# phospho.ELM_kinases=fread("kinase\nAAK1\nAbl\nAbl2\nAbl_drome\nAck_drome\nAFK\nAkt1_drome\nAKT_group_Caeel\nALK\nAMPK_group\nAtg1_drome\nATM\nATR\nAurora A\nAurora B\nAxl\nBCKDK\nBLK\nBMPR1B\nBMX\nBrk\nBRSK1\nBTK\nCaki_drome\nCaM-KI_alpha\nCaM-KI_group\nCaM-KII_alpha\nCaM-KII_delta\nCaMKII_drome\nCaM-KII_group\nCaM-KIV\nCaM-KK_alpha\nCCDPK\nCDC2_drome\nCDK1\nCDK11\nCDK2\nCDK3\nCDK4\nCDK5\nCDK6\nCDK7\nCDK9\nCDK_group\nCDPK\nChak1\nCHK1\nCHK2\nCK1_alpha\nCK1_delta\nCK1_epsilon\nCK1_group\nCK2_alpha\nCK2_beta\nCK2_group\nCK_group_Caeel\nCkI_alpha_drome\nCkII_beta_drome\nCkII_group_drome\nCLK1\nCSF1R\nCsk\nDAPK1\nDAPK2\nDAPK3\nDAPK_group\nDCAMKL1\nDMPK_group\nDNA-PK\nDYRK1A\nDYRK1B\nDYRK2\nDYRK3\nEg3 kinase\nEGFR\nEIF2AK2\nEIF2AK3\nEphA2\nEphA3\nEphA4\nEphA8\nEphB1\nEphB2\nEphB3\nEphB5\nErbB2\nFAK\nFer\nFes\nFGFR1\nFGFR3\nFGFR4\nFGFR_group\nFgr\nFLT1\nFLT3\nFLT4\nfu_drome\nFyn\nGRK-1\nGRK-2\nGRK-3\nGRK-4\nGRK-5\nGRK-6\nGRK_group\nGSK-3_alpha\nGSK-3_beta\nGSK-3_Caeel\nGSK-3_group\nHCK\nHIPK1\nHIPK2\nHIPK3\nhop_drome\nHRI\nICK\nIGF1R\nIKK_alpha\nIKK_beta\nIKK_epsilon\nIKK_group\nILK\nINSR\nIRAK1\nIRAK4\nITK\nJAK1\nJAK2\nJAK3\nJAK_group\nJNK_group\nKDR\nKIS\nKit\nKSR1\nLck\nLIMK1\nLIMK1_drome\nLIMK2\nlit-1_Caeel\nLKB1\nLOK\nLRRK2\nLyn\nMAP2K1\nMAP2K2\nMAP2K3\nMAP2K4\nMAP2K6\nMAP2K7\nMAP2K_group\nMAP3K1\nMAP3K11\nMAP3K14\nMAP3K5\nMAP3K7\nMAP3K8\nMAP3K_group\nMAP4K1\nMAP4K2\nMAPK1\nMAPK10\nMAPK11\nMAPK12\nMAPK13\nMAPK14\nMAPK3\nMAPK4\nMAPK6\nMAPK7\nMAPK8\nMAPK9\nMAPKAPK2\nMAPKAPK5\nMAPK_group\nmapk_group_drome\nMARK_group\nmbk-2_Caeel\nMer\nMet\nMHCK\nMlck_drome\nMLCK_group\nMnk1\nMnk2\nMOS\nMRCKa\nMST1\nMST3\nmTOR\nNDR1\nNDR2\nNEK2\nNEK6\nNEK9\nNLK\nNuaK1\np38_group\np70S6K\np70S6Kb\np70S6K_group\nPAK1\nPAK2\nPAK3\nPAK5\nPak_drome\nPAK_group\nPASK\nPCTAIRE1\nPDGFR_alpha\nPDGFR_beta\nPDGFR_group\nPDHK1\nPDHK2\nPDHK3\nPDHK4\nPDK-1\nPDK-2\nPDKC\nPHK_group\nPIK3CA\nPIK3CB\nPIK3CD\nPIK3CG\nPIM-1\nPKA_alpha\nPka-C1_drome\nPKA_group\nPKA_group_drome\nPKB_beta\nPKB_group\nPKC_alpha\nPKC_beta\nPKC_delta\nPKC_epsilon\nPKC_eta\nPKC_gamma\nPKC_group\nPKC_group_drome\nPKC_iota\nPKC_theta\nPKC_zeta\nPKD1\nPKD2\nPKG1/cGK-I\nPKG2/cGK-II\nPKG/cGK_group\nPKN1\nPLK1\nPLK3\nPRP4\nPYK2\nRAF1\nRET\nROCK1\nROCK2\nROCK_group\nRON\nRSK-1\nRSK-2\nRSK-3\nRSK-5\nRSK_group\nsgg_drome\nSGK_group\nSIK\nSRC\nSRC64B_drome\nSRC_group\nSTLK3\nSYK\nTBK1\nTEC\nTESK1\nTESK2\nTGFbR1\nTGFbR2\nTIE1\nTIE2\nTitin kinase\nTLK1\nTNK2\nTor_drome\nTRKA\nTRKB\nTropomyosin kinase\nTSSK3\nTTK\nTXK\nTyk2\nunc-43_Caeel\nVRK1\nWEE1\nWNK1\nwts_drome\nYes\nZAP70",sep="\n")
# dtk = rbindlist(lapply(phospho.ELM_kinases[,kinase],function(kinase) fread(gsub("; ",";",content(POST(
#   "http://phospho.elm.eu.org/cgimodel.py",body=list(substrate="",accession="",kinase=kinase,sh2="None",organisms="instances_vertebrates",outputCSV="on",fun="Search"),
#   encode="multipart"))))))
# dtk

